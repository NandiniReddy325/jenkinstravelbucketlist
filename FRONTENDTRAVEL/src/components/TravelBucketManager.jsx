// import React, { useState } from 'react';
// import axios from 'axios';
// import "./style.css";
// import config from './config.js';

// const TravelBucketManager = () => {
//   const [place, setPlace] = useState({
//     id: '',
//     destination: '',
//     country: '',
//     notes: '',
//     visited: 'NO'
//   });
//   const [message, setMessage] = useState('');

//   // âœ… Backend base URL
//   const baseUrl = `${config.url}/travelapi`;



//   const handleChange = (e) => {
//     setPlace({ ...place, [e.target.name]: e.target.value });
//   };

//   // âœ… Validation
//   const validateForm = () => {
//     if (!place.destination || !place.country) {
//       setMessage('âš ï¸ Please fill required fields: Destination & Country');
//       return false;
//     }
//     return true;
//   };

//   // âœ… Add new destination (id auto-generated by DB)
//   const addPlace = async () => {
//     if (!validateForm()) return;
//     try {
//       const payload = {
//         destination: place.destination,
//         country: place.country,
//         notes: place.notes,
//         visited: place.visited
//       };
//       await axios.post(`${baseUrl}/add`, payload);

//    // âœ… Correct final URL
//       setMessage('âœ… Destination added successfully!');
//       resetForm();
//     } catch (error) {
//       console.error("Add error:", error);
//       setMessage('âŒ Error adding destination');
//     }
//   };

//   // âœ… Update existing destination
//   const updatePlace = async () => {
//     if (!place.id) {
//       setMessage('âš ï¸ ID is required to update');
//       return;
//     }
//     if (!validateForm()) return;
//     try {
//       await axios.put(`${baseUrl}/update`, place);
//       setMessage('âœ… Destination updated successfully!');
//       resetForm();
//     } catch (error) {
//       console.error("Update error:", error);
//       setMessage('âŒ Error updating destination');
//     }
//   };

//   // âœ… Delete by ID
//   const deletePlace = async () => {
//     if (!place.id) {
//       setMessage('âš ï¸ Enter an ID to delete');
//       return;
//     }
//     try {
//       const res = await axios.delete(`${baseUrl}/delete/${place.id}`);
//       setMessage(res.data || 'âœ… Destination deleted successfully!');
//       resetForm();
//     } catch (error) {
//       console.error("Delete error:", error);
//       setMessage('âŒ Error deleting destination');
//     }
//   };

//   // âœ… Reset form
//   const resetForm = () => {
//     setPlace({
//       id: '',
//       destination: '',
//       country: '',
//       notes: '',
//       visited: 'NO'
//     });
//   };

//   return (
//     <div className="travel-container">
//       {message && (
//         <div
//           className={`message-banner ${
//             message.includes('âŒ') || message.includes('âš ï¸') ? 'error' : 'success'
//           }`}
//         >
//           {message}
//         </div>
//       )}

//       <h2>ğŸŒ Travel Bucket List Manager-Practice</h2>

//       <div className="form-grid">
//         <input
//           type="text"
//           name="destination"
//           placeholder="Destination"
//           value={place.destination}
//           onChange={handleChange}
//         />
//         <input
//           type="text"
//           name="country"
//           placeholder="Country"
//           value={place.country}
//           onChange={handleChange}
//         />
//         <input
//           type="text"
//           name="notes"
//           placeholder="Notes"
//           value={place.notes}
//           onChange={handleChange}
//         />
//         <select name="visited" value={place.visited} onChange={handleChange}>
//           <option value="NO">Not Visited</option>
//           <option value="YES">Visited</option>
//         </select>
//       </div>

//       <div className="btn-group">
//         <button className="btn-blue" onClick={addPlace}>â• Add Destination</button>
//         <input
//           type="number"
//           name="id"
//           placeholder="Enter ID for update/delete"
//           value={place.id}
//           onChange={handleChange}
//         />
//         <button className="btn-green" onClick={updatePlace}>âœï¸ Update Destination</button>
//         <button className="btn-red" onClick={deletePlace}>ğŸ—‘ï¸ Delete Destination</button>
//         <button className="btn-gray" onClick={resetForm}>ğŸ”„ Reset</button>
//       </div>
//     </div>
//   );
// };

// export default TravelBucketManager;






import React, { useState } from 'react';
import axios from 'axios';
import "./style.css";
import config from './config.js';

const TravelBucketManager = () => {
  const [place, setPlace] = useState({
    id: '',
    destination: '',
    country: '',
    notes: '',
    visited: 'NO'
  });
  const [message, setMessage] = useState('');

  // âœ… Use config.url directly (no duplicate /travelapi)
  const baseUrl = config.url;

  const handleChange = (e) => {
    setPlace({ ...place, [e.target.name]: e.target.value });
  };

  // âœ… Validation
  const validateForm = () => {
    if (!place.destination || !place.country) {
      setMessage('âš ï¸ Please fill required fields: Destination & Country');
      return false;
    }
    return true;
  };

  // âœ… Add new destination (id auto-generated by DB)
  const addPlace = async () => {
    if (!validateForm()) return;
    try {
      const payload = {
        destination: place.destination,
        country: place.country,
        notes: place.notes,
        visited: place.visited
      };
      await axios.post(`${baseUrl}/add`, payload);

      setMessage('âœ… Destination added successfully!');
      resetForm();
    } catch (error) {
      console.error("Add error:", error);
      setMessage('âŒ Error adding destination');
    }
  };

  // âœ… Update existing destination
  const updatePlace = async () => {
    if (!place.id) {
      setMessage('âš ï¸ ID is required to update');
      return;
    }
    if (!validateForm()) return;
    try {
      await axios.put(`${baseUrl}/update`, place);
      setMessage('âœ… Destination updated successfully!');
      resetForm();
    } catch (error) {
      console.error("Update error:", error);
      setMessage('âŒ Error updating destination');
    }
  };

  // âœ… Delete by ID
  const deletePlace = async () => {
    if (!place.id) {
      setMessage('âš ï¸ Enter an ID to delete');
      return;
    }
    try {
      const res = await axios.delete(`${baseUrl}/delete/${place.id}`);
      setMessage(res.data || 'âœ… Destination deleted successfully!');
      resetForm();
    } catch (error) {
      console.error("Delete error:", error);
      setMessage('âŒ Error deleting destination');
    }
  };

  // âœ… Reset form
  const resetForm = () => {
    setPlace({
      id: '',
      destination: '',
      country: '',
      notes: '',
      visited: 'NO'
    });
  };

  return (
    <div className="travel-container">
      {message && (
        <div
          className={`message-banner ${
            message.includes('âŒ') || message.includes('âš ï¸') ? 'error' : 'success'
          }`}
        >
          {message}
        </div>
      )}

      <h2>ğŸŒ Travel Bucket List Manager-Practice</h2>

      <div className="form-grid">
        <input
          type="text"
          name="destination"
          placeholder="Destination"
          value={place.destination}
          onChange={handleChange}
        />
        <input
          type="text"
          name="country"
          placeholder="Country"
          value={place.country}
          onChange={handleChange}
        />
        <input
          type="text"
          name="notes"
          placeholder="Notes"
          value={place.notes}
          onChange={handleChange}
        />
        <select name="visited" value={place.visited} onChange={handleChange}>
          <option value="NO">Not Visited</option>
          <option value="YES">Visited</option>
        </select>
      </div>

      <div className="btn-group">
        <button className="btn-blue" onClick={addPlace}>â• Add Destination</button>
        <input
          type="number"
          name="id"
          placeholder="Enter ID for update/delete"
          value={place.id}
          onChange={handleChange}
        />
        <button className="btn-green" onClick={updatePlace}>âœï¸ Update Destination</button>
        <button className="btn-red" onClick={deletePlace}>ğŸ—‘ï¸ Delete Destination</button>
        <button className="btn-gray" onClick={resetForm}>ğŸ”„ Reset</button>
      </div>
    </div>
  );
};

export default TravelBucketManager;
